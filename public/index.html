<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>å¤šæ™ºèƒ½ä½“ç§‘ç ”è®ºæ–‡é—®ç­”ç³»ç»Ÿ</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM CDN -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        .message-container {
            overflow-y: auto;
            height: calc(100vh - 180px);
        }
        .user-message {
            background-color: #f1f5f9;
        }
        .assistant-message {
            background-color: #ffffff;
            border: 1px solid #e2e8f0;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
<div id="root"></div>

<script type="text/babel">
    const { useState, useEffect, useRef } = React;

    function App() {
        const [messages, setMessages] = useState([
            {
                id: 1,
                role: 'assistant',
                content: 'æ‚¨å¥½ï¼æˆ‘æ˜¯å¤šæ™ºèƒ½ä½“ç§‘ç ”è®ºæ–‡æ£€ç´¢åŠ©æ‰‹ï¼Œè¯·é—®æ‚¨æƒ³æŸ¥è¯¢ä»€ä¹ˆé¢†åŸŸçš„è®ºæ–‡ï¼Ÿä¾‹å¦‚ï¼šâ€œæœ€è¿‘å…³äºå¤§è¯­è¨€æ¨¡å‹çš„ç»¼è¿°æœ‰å“ªäº›ï¼Ÿâ€',
            }
        ]);
        const [inputValue, setInputValue] = useState('');
        const [isLoading, setIsLoading] = useState(false);
        const messagesEndRef = useRef(null);

        const scrollToBottom = () => {
            messagesEndRef?.current?.scrollIntoView({ behavior: "smooth" });
        };

        useEffect(() => {
            scrollToBottom();
        }, [messages]);

        const handleSubmit = async (e) => {
            e.preventDefault();
            if (!inputValue.trim() || isLoading) return;

            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
            const userMessage = {
                id: Date.now(),
                role: 'user',
                content: inputValue.trim(),
            };
            setMessages((prev) => [...prev, userMessage]);
            setInputValue('');
            setIsLoading(true);

            // æ¨¡æ‹Ÿåç«¯è°ƒç”¨ï¼ˆæ›¿æ¢ä¸ºå®é™… API è°ƒç”¨ï¼‰
            try {
                // ğŸ‘‡ æ¨¡æ‹Ÿ 1.5 ç§’çš„â€œæ€è€ƒâ€æ—¶é—´
                await new Promise((resolve) => setTimeout(resolve, 1500));

                // æ¨¡æ‹Ÿå¤šæ™ºèƒ½ä½“ç³»ç»Ÿå›å¤ï¼ˆå®é™…åº”ä» API è·å–ï¼‰
                const assistantReply = {
                    id: Date.now() + 1,
                    role: 'assistant',
                    content: `æ­£åœ¨ä¸ºæ‚¨æ£€ç´¢ä¸â€œ${inputValue}â€ç›¸å…³çš„ç§‘ç ”è®ºæ–‡â€¦â€¦\n\nä¾‹å¦‚ï¼š\n- ã€ŠA Survey on Large Language Modelsã€‹(2024)\n- ã€ŠEfficient Retrieval-Augmented Generation for Scientific QAã€‹(NeurIPS 2024)\n\næ˜¯å¦éœ€è¦æˆ‘æä¾›æ‘˜è¦æˆ– PDF é“¾æ¥ï¼Ÿ`,
                };
                setMessages((prev) => [...prev, assistantReply]);
            } catch (error) {
                setMessages((prev) => [
                    ...prev,
                    {
                        id: Date.now() + 1,
                        role: 'assistant',
                        content: 'æŠ±æ­‰ï¼Œç³»ç»Ÿæš‚æ—¶æ— æ³•å¤„ç†è¯·æ±‚ï¼Œè¯·ç¨åå†è¯•ã€‚âš ï¸',
                    },
                ]);
            } finally {
                setIsLoading(false);
            }
        };

        return (
            <div className="max-w-4xl mx-auto p-4 flex flex-col h-screen">
                {/* Header */}
                <div className="py-4 text-center">
                    <h1 className="text-2xl font-bold text-gray-800">å¤šæ™ºèƒ½ä½“ç§‘ç ”è®ºæ–‡é—®ç­”ç³»ç»Ÿ</h1>
                    <p className="text-sm text-gray-500">åŸºäºå¤šæ™ºèƒ½ä½“åä½œçš„æ™ºèƒ½æ–‡çŒ®æ£€ç´¢ä¸é—®ç­”</p>
                </div>

                {/* Messages */}
                <div className="message-container mb-4 space-y-4">
                    {messages.map((msg) => (
                        <div
                            key={msg.id}
                            className={`p-4 rounded-lg max-w-3xl ${msg.role === 'user' ? 'user-message ml-auto' : 'assistant-message'}`}
                        >
                            <div className="font-semibold text-gray-700 mb-1">
                                {msg.role === 'user' ? 'You' : 'å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ'}
                            </div>
                            <div className="whitespace-pre-wrap text-gray-800">{msg.content}</div>
                        </div>
                    ))}

                    {isLoading && (
                        <div className="p-4 rounded-lg assistant-message max-w-3xl">
                            <div className="font-semibold text-gray-700 mb-1">å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ</div>
                            <div className="flex space-x-2">
                                <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></div>
                                <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: '0.2s' }}></div>
                                <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: '0.4s' }}></div>
                            </div>
                        </div>
                    )}
                    <div ref={messagesEndRef} />
                </div>

                {/* Input Form */}
                <form onSubmit={handleSubmit} className="mt-auto">
                    <div className="flex gap-2">
                        <input
                            type="text"
                            value={inputValue}
                            onChange={(e) => setInputValue(e.target.value)}
                            placeholder="è¯·è¾“å…¥æ‚¨çš„ç§‘ç ”é—®é¢˜ï¼Œä¾‹å¦‚ï¼šæœ€è¿‘å…³äºæ‰©æ•£æ¨¡å‹çš„è®ºæ–‡æœ‰å“ªäº›ï¼Ÿ"
                            className="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            disabled={isLoading}
                        />
                        <button
                            type="submit"
                            className={`px-6 py-3 rounded-lg font-medium ${isLoading ? 'bg-gray-400 cursor-not-allowed' : 'bg-blue-600 hover:bg-blue-700 text-white'}`}
                            disabled={isLoading || !inputValue.trim()}
                        >
                            å‘é€
                        </button>
                    </div>
                </form>
            </div>
        );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>
</body>
</html>